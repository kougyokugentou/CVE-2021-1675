#requires -module ActiveDirectory

$SearchBase1 = "dn of ou you want to collect computers from"
$SearchBase2 = "dn of another ou you want to collect computers from"

#Collect servers we want to configure
$YourServers = (Get-ADComputer -Filter * -SearchBase $SearchBase1 ).Name

#You may need to do this a few times as this example below or comment this out if you don't want another searchbase.
#just keep adding to $YourServers as in the example and change the SearchBase
$YourServers += (Get-ADComputer -Filter * -SearchBase $SearchBase2).Name

$YourServers = $YourServers | Sort

# Specify the configuration.
configuration DisablePrintSpooler
{
    param($computername)

    Import-DscResource -ModuleName PSDesiredStateConfiguration

    Node $computername
    {
        LocalConfigurationManager
        {
            RebootNodeIfNeeded = $false
            RefreshMode        = 'PUSH'
        }

        Service PrintSpooler
        {
            Name = "Spooler"
            StartupType = "Disabled"
            State = "Stopped"
        }
    }
}

Set-Location C:\DSC\

# Generate the MOFs
ForEach($item in $YourServers) {DisablePrintSpooler -computername $item}

# PUSH META CONFIGURATION
Set-DscLocalConfigurationManager -Path .\DisablePrintSpooler -Verbose

# PUSH CONFIGURATION
ForEach ($item in $YourServers) 
{
    Start-DscConfiguration -Path .\DisablePrintSpooler -ComputerName $item -Wait -Verbose -Force
}
